# Minimal AWS test configuration for harmony-run chart

global:
  namespace: harmony
  platform: aws

harmony:
  image:
    name: harmony
    repository: cleodev/harmony
    tag: "latest"
    pullPolicy: Always

  statefulset:
    replicas: 1
    ordinalStart: 1

  env:
    systemName: "TestSystemAWS"
    secretsMountPoint: "/var/secrets"

  resources:
    requests:
      memory: "2048Mi"
    limits:
      memory: "4096Mi"

  volumes:
    secrets:
      sources:
        - secretName: cleo-license
        - secretName: cleo-license-verification-code
        - secretName: cleo-config-repo
        - secretName: cleo-runtime-repo
        - secretName: cleo-log-system
          optional: true

service:
  headless:
    enabled: true
    name: harmony-service

  loadBalancer:
    enabled: true
    name: harmony
    type: LoadBalancer
    sessionAffinity: ClientIP
    externalTrafficPolicy: Local
    
    ports:
      - name: admin
        port: 5080
        targetPort: 5080
        enabled: true
      - name: http
        port: 80
        targetPort: 80
        enabled: false
      - name: https
        port: 443
        targetPort: 443
        enabled: false

    passiveFtp:
      enabled: false

persistence:
  enabled: false
  claimName: "harmony-pvc"
  mountPath: "/shared-config"
