# Production AWS configuration with multiple replicas and optimized settings

global:
  namespace: harmony-prod
  platform: aws

harmony:
  image:
    name: harmony
    repository: cleodev/harmony
    tag: "1.0.0"
    pullPolicy: IfNotPresent

  statefulset:
    replicas: 3
    ordinalStart: 1

  env:
    systemName: "ProductionSystemAWS"
    secretsMountPoint: "/var/secrets"

  resources:
    requests:
      memory: "4096Mi"
    limits:
      memory: "8192Mi"

  volumes:
    secrets:
      sources:
        - secretName: cleo-license
        - secretName: cleo-license-verification-code
        - secretName: cleo-config-repo
        - secretName: cleo-runtime-repo
        - secretName: cleo-log-system
          optional: false

service:
  headless:
    enabled: true
    name: harmony-service

  loadBalancer:
    enabled: true
    name: harmony
    type: LoadBalancer
    sessionAffinity: ClientIP
    externalTrafficPolicy: Local
    
    ports:
      - name: admin
        port: 5080
        targetPort: 5080
        enabled: true
      - name: http
        port: 80
        targetPort: 80
        enabled: true
      - name: https
        port: 443
        targetPort: 443
        enabled: true
      - name: sftp
        port: 22
        targetPort: 22
        enabled: true
      - name: ftp-control
        port: 21
        targetPort: 21
        enabled: true
      - name: ftp-data
        port: 20
        targetPort: 20
        enabled: true

    passiveFtp:
      enabled: true
      passivePorts:
        - name: ftp-passive-1
          port: 25900
          targetPort: 25900
        - name: ftp-passive-2
          port: 25901
          targetPort: 25901
        - name: ftp-passive-3
          port: 25902
          targetPort: 25902

persistence:
  enabled: true
  claimName: "harmony-pvc"
  mountPath: "/shared-config"
